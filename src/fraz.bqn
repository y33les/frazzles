âŸ¨ Get, Post âŸ© â† â€¢Import "../lib/bqn-curl/curl.bqn"

fraz â‡ {
  r â† Get "https://httpbin.org/get"
  Test â‡ { ğ•©âˆ¾r.code }
}

# Various help strings # TODO: spin out into another file/namespace
helpMsg â† "Usage: fraz [init|add|remove|search|help] [help|<args>]

  init: Initialise a new Frazzle in the current directory (or another directory, if given)
   add: Add one or more Frazzles to lib/ in the current directory
remove: Remove one or more Frazzles from lib/ in the current directory
search: Query available Frazzles on frazzl.es (or $FRAZZLES_INDEX, if defined)
  help: Display this message

You can also call 'fraz <command> help for more in-depth help with a specific command."
initHelpMsg â† "TODO: init help message" # TODO
addHelpMsg â† "TODO: add help message" # TODO
removeHelpMsg â† "TODO: remove help message" # TODO
searchHelpMsg â† "TODO: search help message" # TODO
helpHelpMsg â† "You think you're funny, don't you?"
badCmdError â† "ERROR: allowed commands are 'init', 'add', 'remove', 'search' and 'help'."

# Process arguments: fraz <cmd> <args>
args â† â€¢args
{ 0=â‰ ğ•© ? â€¢Out helpMsg â‹„ â€¢Exit 0 ; @ }args # Display help message if no arguments provided
cmd â† âŠ‘args
cmdSet â† "init"â€¿"add"â€¿"remove"â€¿"search"â€¿"help" # Allowed commands
{ âˆŠâŸœcmdSetâŒ¾<cmd ? @ ; â€¢Out badCmdError â‹„ â€¢Exit Â¯1 } # Fail if cmd is unknown
args 1âŠ¸â†“â†©

# Check if a directory is already a Frazzle
IsFrazzle â† {
  â€¢file.Exists ğ•© â€¢file.At ".frazzle"
}

Init â† {
  #badInitError â† "ERROR: "
  #{1<â‰ ğ•© ? â€¢Out badInitError â‹„ â€¢Exit Â¯1 ; @ }
  ğ•©
}
Add â† { â€¢ShowâŒ½ğ•© }
Remove â† { â€¢ShowâŒ½Â¨ğ•© }
Search â† { â€¢Showâˆ˜â€¿1â¥Šğ•© }
Help â† {
  0=â‰ ğ•© ? â€¢Out helpMsg ; "help"â‰¡âŠ‘ğ•© ? â€¢Out helpHelpMsg ; â€¢Out "Usage: fraz help" â‹„ â€¢Exit Â¯1 
}

# Run it!
{ cmdâ‰¡"init" ? Init args ; @ }
{ cmdâ‰¡"add" ? Add args ; @ }
{ cmdâ‰¡"remove" ? Remove args ; @ }
{ cmdâ‰¡"search" ? Search args ; @ }
{ cmdâ‰¡"help" ? Help args ; @ }